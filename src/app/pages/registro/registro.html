<main class="container g-3 my-5">
  <article class="">
    <div class="card-body">
      <h4 class="mb-3 color-principal">Registrate y empieza tu aventura</h4>

      <form [formGroup]="userForm" (ngSubmit)="onSubmit()" novalidate>
        <div class="mb-3">
          <label class="form-label">Usuario</label>
          <input
            class="form-control"
            formControlName="username"
            placeholder="Usuario"
            [class.is-invalid]="isInvalid('username')"
          />
          @if (isInvalid('username') && userForm.get('username')?.errors) {
          <div class="invalid-feedback">
            @if (userForm.get('username')?.errors?.['required']) {
            <div>El usuario es obligatorio.</div>
            } @if (userForm.get('username')?.errors?.['minlength']) {
            <div>Mínimo 3 caracteres.</div>
            }
          </div>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">Email</label>
          <input
            type="email"
            class="form-control"
            formControlName="email"
            placeholder="email@dominio.com"
            [class.is-invalid]="isInvalid('email')"
          />
          @if (isInvalid('email') && userForm.get('email')?.errors) {
          <div class="invalid-feedback">
            @if (userForm.get('email')?.errors?.['required']) {
            <div>El email es obligatorio.</div>
            } @if (userForm.get('email')?.errors?.['email']) {
            <div>Formato de email inválido.</div>
            }
          </div>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">Contraseña</label>
          <input
            type="password"
            class="form-control"
            formControlName="password"
            placeholder="Contraseña"
            [class.is-invalid]="isInvalid('password')"
          />
          @if (isInvalid('password') && userForm.get('password')?.errors) {
          <div class="invalid-feedback">
            @if (userForm.get('password')?.errors?.['required']) {
            <div>La contraseña es obligatoria.</div>
            } @if (userForm.get('password')?.errors?.['minlength']) {
            <div>Mínimo 6 caracteres.</div>
            }
          </div>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">Repite la contraseña</label>
          <input
            type="password"
            class="form-control"
            formControlName="repeatPassword"
            placeholder="Repite la contraseña"
            (paste)="(false)"
            [class.is-invalid]="isInvalid('repeatPassword') || ((submitted || userForm.get('repeatPassword')?.touched) && userForm.errors?.['passwordsMismatch'])"
          />
          @if ( (isInvalid('repeatPassword') && userForm.get('repeatPassword')?.errors) ||
          ((submitted || userForm.get('repeatPassword')?.touched) &&
          userForm.errors?.['passwordsMismatch']) ) {
          <div class="invalid-feedback">
            @if (userForm.get('repeatPassword')?.errors?.['required']) {
            <div>Debes repetir la contraseña.</div>
            } @if (userForm.errors?.['passwordsMismatch']) {
            <div>Las contraseñas no coinciden.</div>
            }
          </div>
          }
        </div>

        <!-- <div class="mb-3">
          <label class="upload-label">Imagen (Archivo, máx. 200kb)</label>
          <input
            type="file"
            accept="image/*"
            class="form-control"
            [class.is-invalid]="isInvalid('image')"
          />
          @if (imageError) {
          <div class="invalid-feedback">{{ imageError }}</div>
          }
        </div> -->

        <div class="mb-3">
          <label class="form-label">Teléfono</label>
          <input
            class="form-control"
            formControlName="telefono"
            placeholder="Teléfono"
            [class.is-invalid]="isInvalid('telefono')"
          />
          @if (isInvalid('telefono') && userForm.get('telefono')?.errors) {
          <div class="invalid-feedback">
            @if (userForm.get('telefono')?.errors?.['pattern']) {
            <div>Teléfono inválido.</div>
            }
          </div>
          }
        </div>

        <div class="mb-3">
          <label class="form-label">Sobre ti</label>
          <textarea
            class="form-control"
            formControlName="descripcion"
            rows="4"
            maxlength="500"
            placeholder="Breve descripción"
          ></textarea>
          <small class="text-muted">
            {{ userForm.get('descripcion')?.value?.length || 0 }}/500 caracteres
          </small>
        </div>

        <div class="mb-3">
          <label class="form-label">Intereses</label>
          <textarea
            class="form-control"
            formControlName="intereses"
            rows="4"
            maxlength="500"
            placeholder="Cuenta al resto de viajeros sobre tus intereses"
          ></textarea>
          <small class="text-muted">
            {{ userForm.get('intereses')?.value?.length || 0 }}/500 caracteres
          </small>
        </div>

        <div class="d-flex gap-2 mt-3">
          <button class="btn btn-outline-secondary btn-morado w-100 mb-2" type="submit">
            Aceptar y registrarme
          </button>
        </div>
      </form>
    </div>
  </article>
</main>
